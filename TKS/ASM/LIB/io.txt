;       модуль с процедурами файлового ввода вывода	дата создания: 05.12.02
.model small
.386
.code

PUBLIC FileCreate,FileRead,FileClose,FileWrite,FileOpen,FileSize

FileCreate proc near		;создает файл с именем,находящимся в DX
	push cx
  	mov ah,3ch              ;функция создания файла
  	mov cx,0		;нормальные атрибуты
  	int 21h
	pop cx
  	ret 
endp  

FileRead:			;требует: CX-длина буфера  DX-буфер
  	mov ah,3fh		;	  BX-дескриптор файла
  	int 21h
  	ret 

FileWrite:			;требует: CX-длина буфера  DX-буфер
  	mov ah,40h		;	  BX-дескриптор файла
  	int 21h
 	ret 

FileOpen:			;возвращает дескриптор открытого файла в AX
  	mov ah,3dh		;в DX - строка с именем открываемого файла
  	int 21h
  	ret 

FileClose:			;в BX - дескриптор закрываемого файла
  	mov ah,3ch
  	int 21h
  	ret 

FileSize:			;BX - дескриптор файла
	push cx			;на выходе DX:AX - длина файла
  	mov ah,42h
  	mov al,2		;начальная позиция-с конца
  	mov cx,0		;старшее слово смещения начальной позиции
  	mov dx,0		;младшее слово смещения начальной позиции
  	int 21h
  	push dx	ax		;сохраняем результат
;теперь надо восстановить позицию указателя-переместить его в начало файла
  	mov ah,42h
  	mov al,0		;начальная позиция-с начала файла
  	mov cx,0		;старшее слово смещения начальной позиции
  	mov dx,0		;младшее слово смещения начальной позиции
  	int 21h
  	pop ax dx cx
  	ret
end  
